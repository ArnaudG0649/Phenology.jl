var documenterSearchIndex = {"docs":
[{"location":"freezing_risk/#Freezing-risk","page":"Freezing Risk","title":"Freezing risk","text":"","category":"section"},{"location":"freezing_risk/#Phenology.FreezingRisk","page":"Freezing Risk","title":"Phenology.FreezingRisk","text":"FreezingRisk(TN_vec::AbstractVector, Date_vec::AbstractVector{Date}, BB::Date; threshold=-2., PeriodOfInterest=Month(3), CPO=(10, 30))\nFreezingRisk(df::DataFrame, BB; threshold=-2., PeriodOfInterest=Month(3), CPO=(8, 1))\n\nFor a given budburst date BB return the number of days with minimal temperature inferior to threshold for the period PeriodOfInterest after this date but always before the next chilling period onset CPO (next phenological cycle).\n\n\n\n\n\n","category":"function"},{"location":"freezing_risk/#Phenology.FreezingRiskMatrix-Tuple{Any, Any, AbstractVector{Dates.Date}}","page":"Freezing Risk","title":"Phenology.FreezingRiskMatrix","text":"FreezingRiskMatrix(TN_vec, Date_vec, date_vecBB::AbstractVector{Date}; threshold=-2., PeriodOfInterest=Month(3), CPO=(10, 30))\n\nFor a given budburst date vector date_vecBB return the number of days with minimal temperature inferior to threshold for each year in a N x 2 matrix\n\n\n\n\n\n","category":"method"},{"location":"freezing_risk/#Phenology.FreezingRiskMatrix-Tuple{Any, Any, Any}","page":"Freezing Risk","title":"Phenology.FreezingRiskMatrix","text":"FreezingRiskMatrix(TN_vecs, Date_vec, date_vecsBB; threshold=-2., PeriodOfInterest=Month(3), CPO=(10, 30))\n\nFor a sample of daily minimal temperatures series TN_vecs and their respectives budburst dates date_vecsBB return a matrix with the number of scenarios which have n days with minimal temperature inferior to threshold for n in row and the year in column.\n\n\n\n\n\n","category":"method"},{"location":"BRIN_train/#Training-BRIN-models","page":"Training BRIN model","title":"Training BRIN models","text":"With this module you can fit BRIN models on temperatures data and registered phenological dates as training set. For example below we train a BRIN model on Montpellier temperatures and bud burst dates of Chasselas variety registered at the Domaine de Vassal (43.327676, 3.565170). The file Data_BB.xlsx is available in the github repository.\n\nusing Phenology\n\n#TN (daily minimal) and TX (daily maximal) temperatures in Montpellier, from 1946 to 2022.\ndate_vec, x = Common_indexes(joinpath(stations_folder, \"TN_Montpellier.txt\"), joinpath(stations_folder, \"TX_Montpellier.txt\"))\n\n#Importing bud burst data.\ndf_vassal_chasselas = @chain begin\n    DataFrame(XLSX.readtable(joinpath(@__DIR__, \"Data_BB.xlsx\"), \"data_Tempo\"))\n    @subset(:variete_cultivar_ou_provenance .== \"Chasselas\")\n    @subset(:nom_du_site .== \"INRA Domaine de Vassal\")\nend\ndate_vecBB = Date.(df_vassal_chasselas.date)\n\n#Fitting model\nmodel = BRIN_Model(date_vec, x, date_vecBB)\n\nYou can also put the years and the days of the year doy in the example as an integer (the number of days between the 1ˢᵗ of January and the date) of the bud burst in two separate vectors :\n\nyears = df_vassal_chasselas.annee\ndoy = df_vassal_chasselas.jour_de_l_annee\nmodel = BRIN_Model(date_vec, x, years, doy)\n\nThe method BRIN_Model(x_vec::AbstractVector, n_train::AbstractVector) takes as arguments two vectors of same length, for which each element is associated to a year :\n\nx_vec is a vector of series of yearly temperatures between the 1ˢᵗ of August of the precedent year and 30ᵗʰ of July of the current year.\nn_train is a vector of numbers of days between the 1ˢᵗ of August of the precedent year associated and the bud burst date.\n\nExample :\n\nn_train = [doy[i] + length(Date(year - 1, 8, 1):Date(year - 1, 12, 31)) for (i,year) in enumerate(years)] #doy + nb of days between 1ˢᵗ of August and the last day of the year\nx_vec = [x[Date(year - 1, 8, 1) .<= date_vec .< Date(year, 8, 1), :] for year in years]\nmodel = BRIN_Model(x_vec, n_train)","category":"section"},{"location":"Plotting/#Plots-with-CairoMakie","page":"Plot extension with CairoMakie","title":"Plots with CairoMakie","text":"Before calling one of these functions you must load CairoMakie.jl with \n\nusing CairoMakie","category":"section"},{"location":"Plotting/#Plot-series-of-endodormancy-break-and-budburst-Dates","page":"Plot extension with CairoMakie","title":"Plot series of endodormancy break and budburst Dates","text":"","category":"section"},{"location":"Plotting/#Plot-Freezing-Risk","page":"Plot extension with CairoMakie","title":"Plot Freezing Risk","text":"","category":"section"},{"location":"Plotting/#Phenology.Plot_Pheno_Dates_EB_BB-Tuple{Vector{Dates.Date}, Vector{Dates.Date}, Any}","page":"Plot extension with CairoMakie","title":"Phenology.Plot_Pheno_Dates_EB_BB","text":"Phenology.Plot_Pheno_Dates_EB_BB(date_vecEB::Vector{Date},\n    date_vecBB::Vector{Date},\n    CPO;\n    sample_EB=nothing,\n    sample_BB=nothing,\n    station_name=\"\",\n    YearCut=nothing,\n    save_file=nothing,\n    loaded_data=nothing,\n    display_legend=true)\n\nPlot the dormancy break and budburst dates from the series date_vecEB and date_vecBB and if precised from the samples sample_EB and sample_BB.\n\n\n\n\n\n","category":"method"},{"location":"Plotting/#Phenology.Plot_Pheno_Dates_EB_BB-Tuple{Any, Any, Any}","page":"Plot extension with CairoMakie","title":"Phenology.Plot_Pheno_Dates_EB_BB","text":"Phenology.Plot_Pheno_Dates_EB_BB(date_vecsEB, date_vecsBB, CPO;\n    EB_colors=nothing,\n    BB_colors=nothing,\n    EB_label=nothing,\n    BB_label=nothing,\n    dashindexes=Integer[],\n    size=(800, 400),\n    breakpoints=true,\n    comments=\"\")\n\nPlot the dormancy break and budburst dates from the series date_vecsEB and date_vecsBB.\n\n\n\n\n\n","category":"method"},{"location":"Plotting/#Phenology.PlotHistogram","page":"Plot extension with CairoMakie","title":"Phenology.PlotHistogram","text":"Phenology.PlotHistogram(date_vecEB::Vector{Date},\n    date_vecBB::Vector{Date},\n    CPO,\n    year;\n    sample_EB=nothing,\n    sample_BB=nothing,\n    station_name=\"\",\n    LineHeight=0.15,\n    stationlegend=false,\n    horline=true,\n    PlotQuantile=false)\n\nFor the year precised, plot the histogram of the endodormancy break and budburst dates from the samples sample_EB and sample_BB. It plots also the phenological dates of that year from date_vecEB and date_vecBB as vertical lines.   \n\n\n\n\n\n","category":"function"},{"location":"Plotting/#Phenology.Plot_Freeze_Risk","page":"Plot extension with CairoMakie","title":"Phenology.Plot_Freeze_Risk","text":"Phenology.Plot_Freeze_Risk(TN_vecs, dates_vecs_TN, date_vecsBB;\n    CPO=(8, 1),\n    colors=nothing,\n    label=nothing,\n    size=(800, 400),\n    threshold=-2)\n\nFor multiple daily minimal temperatures series TN_vecs and their respective dates dates_vecs_TN and BudBurst dates date_vecsBB, plot the number of days with TN < threshold per year.\n\n\n\n\n\n","category":"function"},{"location":"Plotting/#Phenology.Plot_Freeze_Risk_sample","page":"Plot extension with CairoMakie","title":"Phenology.Plot_Freeze_Risk_sample","text":"Phenology.Plot_Freeze_Risk_sample(TN_vecs,\n    Date_vec,\n    date_vecsBB;\n    threshold=-2.,\n    PeriodOfInterest=Month(3),\n    CPO=(10, 30),\n    size_fig=(1300, 400))\n\nFor a sample of daily minimal temperatures series TN_vecs and budburst series date_vecsBB with their date Date_vec plot the yearly mean, variance and maximum of number of days with TN < threshold.  \n\n\n\n\n\n","category":"function"},{"location":"Plotting/#Phenology.Plot_Freeze_Risk_Bar","page":"Plot extension with CairoMakie","title":"Phenology.Plot_Freeze_Risk_Bar","text":"Phenology.Plot_Freeze_Risk_Bar(TN_vec, dates_vec_TN, date_vecBB;\n    CPO=(8, 1),\n    color=nothing,\n    label=nothing,\n    size=(800, 400),\n    threshold=-2)\n\nFor a series of daily minimal temperatures TN_vec and his respective dates dates_vec_TN and BudBurst dates date_vecsBB, plot the number of days with TN < threshold per year.\n\n\n\n\n\n","category":"function"},{"location":"Temp_data/#Temperatures-data-compatibility","page":"Temperatures data compatibility","title":"Temperatures data compatibility","text":"As you can see in Phenological models for each species, each function that predicts phenological dates from temperatures have methods which take in arguments data temperatures either as vector (for example TG_vec), dataframe or .txt file. In this page we will explain which temperatures data file this package can handle and how the data is extracted to be used.\n\nBelow we present the two types of file in format .txt tolerated by this package : \n\nRecorded temperatures data file from the European Climate Assessment and Dataset (abbreviated ECA&D). The name of the file has to start with \"TN\", \"TG\" or \"TX\" to not be miskaten with the second type of file : \nClimate projections collected on the portal DRIAS Les futurs du climat.\n\nSome data file examples are available in the station folder on the github repository of the package.  This package has functions which can read and clean the data temperatures and their dates and return them in a dataframe object :\n\nSome functions (like Phenology.Apple_Phenology_Pred) can take as arguments directly the name of the file to return phenology predictions by calling a method which itself calls extract_series. They can also take dataframes which have a DATE and TN, TG or TX columns. Because some phenological models need daily temperatures of multiple type, if they are extracted from different files with different timelines, we need to truncate this data to have a common timeline. This is the role of Common_indexes : ","category":"section"},{"location":"Temp_data/#Phenology.extract_series","page":"Temperatures data compatibility","title":"Phenology.extract_series","text":"extract_series(file::String; year=nothing)\n\nExtracts the temperatures time series from file and return a dataframe. You can precise the year with the argument year. If truncate_results = true, truncates the series with the function truncate_MV. If the file name starts with \"TN\", \"TG\" or \"TX\", the function considers that it is an ECA&D file and returns a dataframe with a date column and one temperature column of the type precised in the name of the file. Otherwise it considers that it is a file from the DRIAS database so it returns a dataframe with one column for the date and three columns for the three types of daily temperatures.\n\n\n\n\n\n","category":"function"},{"location":"Temp_data/#Phenology.truncate_MV","page":"Temperatures data compatibility","title":"Phenology.truncate_MV","text":"truncate_MV(df)\n\nTruncates the dataframe of temperatures series df to remove missing values. If there is a missing value in the last 1000 values, it removes all the values after. If there is a missing value before, the function removes all the values before.\n\n\n\n\n\n","category":"function"},{"location":"Temp_data/#Phenology.Common_indexes","page":"Temperatures data compatibility","title":"Phenology.Common_indexes","text":"Common_indexes(series_vec::AbstractVector{DataFrame})\nCommon_indexes(files...)\n\nFrom different ECA&D-type dataframes (with 2 colums) in series_vec or extracted in files return a tuple with the series of their mutual date and their associated temperatures in a matrix. For example if we consider a dataframe df_TN of daily minimal temperatures from 1985 to 2010 and another one df_TX of daily maximal temperatures from 1970 to 2005, Common_indexes(df_TN,df_TX) will return a tuple (date_vec, x) where :\n\ndate_vec is the dates vector (each day as Date object) for the period 1985-2005.\nx is a matrix where the first column is the series of daily minimal temperatures and the second the series of daily maximal temperatures, both corresponding to the dates in date_vec.\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"stations_folder = join(\"stations\")#hide\nnothing#hide","category":"section"},{"location":"#Phenology.jl","page":"Home","title":"Phenology.jl","text":"Welcome to the documentation for Phenology.jl ! With this package you can predict the phenology (budburst and endo dormancy break) of apple and grapevine from temperatures data. The models used are the ones presented in Legave et al. (2013) for apple (F1 Gold 1) and in García de Cortázar-Atauri et al. (2009) for grapevine (BRIN model).","category":"section"},{"location":"#Tutorial","page":"Home","title":"Tutorial","text":"","category":"section"},{"location":"#Data-extraction","page":"Home","title":"Data extraction","text":"First, we need a file with the temperatures data and their dates. This package is adapted to use some type of txt.file from the ECA&D database and the portal DRIAS Les futurs du climat as it is explained in the section Temperatures data compatibility The data files examples used in this tutorial are available in the station folder on the github repository of the package. As you will see further, the functions to predict phenological dates can take as arguments the data file path but if you want to extract the data in a dataframe you can use the function Phenology.extract_series :\n\nusing Phenology\n#average daily temperatures in Montpellier\ndf_TG_Montpellier = extract_series(joinpath(stations_folder, \"TG_Montpellier.txt\"))\nfirst(df_TG_Montpellier, 10)","category":"section"},{"location":"#Apple-Phenology","page":"Home","title":"Apple Phenology","text":"To predict apple dormancy break and budburst dates, just call the function Apple_Phenology_Pred on daily average temperatures data :\n\nA_EB_Montpellier, A_BB_Montpellier = Apple_Phenology_Pred(df_TG_Montpellier.TG, df_TG_Montpellier.DATE)\nfirst(A_BB_Montpellier, 5) #The budburst dates of the 5 first years.\n\nNote that Apple_Phenology_Pred(df_TG_Montpellier) and Apple_Phenology_Pred(joinpath(\"stations\", \"TG_Montpellier.txt\")) return the same output.","category":"section"},{"location":"#Grapevine-Phenology","page":"Home","title":"Grapevine Phenology","text":"To predict grapevine dormancy break and budburst dates, call the function Vine_Phenology_Pred on daily minimal and maximal temperatures data :\n\nG_EB_Montpellier, G_BB_Montpellier = Vine_Phenology_Pred(joinpath(stations_folder, \"TN_Montpellier.txt\"), joinpath(stations_folder, \"TX_Montpellier.txt\"))\nfirst(G_BB_Montpellier, 5)\n\nLike the apple function, calling the other methods with dataframes or vectors return the same results (see Vine_Phenology_Pred).","category":"section"},{"location":"#Freezing-Risk","page":"Home","title":"Freezing Risk","text":"You can also predict the risk of freezing after budburst with the functions FreezingRisk and FreezingRiskMatrix, based on minimal daily temperatures, their dates and the budburst dates :\n\ndf_TN_Bonn = extract_series(joinpath(stations_folder, \"TN_Bonn.txt\"))\nA_EB_Bonn, A_BB_Bonn = Apple_Phenology_Pred(joinpath(stations_folder, \"TG_Bonn.txt\"))\nnothing#hide\n\nFor example we predict the freezing risk after the fourth apple budburst in 1981 :\n\nFreezingRisk(df_TN_Bonn, A_BB_Bonn[4])\n\nOr after all apple budburst :\n\nFreezingRiskMatrix(df_TN_Bonn, A_BB_Bonn)","category":"section"},{"location":"#Plots-with-[CairoMakie](https://docs.makie.org/stable/explanations/backends/cairomakie.html)-extension.","page":"Home","title":"Plots with CairoMakie extension.","text":"If you have the package CairoMakie.jl loaded, you can use multiple plot functions, showed in Plots with CairoMakie section. For example you can plot the annual phenological dates from predictions on multiple sites :\n\nusing CairoMakie\n\nA_EB_Nantes, A_BB_Nantes = Apple_Phenology_Pred(joinpath(stations_folder, \"TG_Nantes.txt\"))\n\ncolors = [\"blue\", \"orange\", \"green\"]\nlabel = [\"Montpellier\", \"Bonn\", \"Nantes\"]\nPlot_Pheno_Dates_EB_BB([A_EB_Montpellier, A_EB_Bonn, A_EB_Nantes],\n    [A_BB_Montpellier, A_BB_Bonn, A_BB_Nantes],\n    (10, 30),\n    EB_label=label,\n    BB_label=label,\n    EB_colors=colors,\n    BB_colors=colors\n)\n\nOr the freezing risks :\n\nPlot_Freeze_Risk_Bar(df_TN_Bonn, A_BB_Bonn,\n    color=\"orange\",\n    label=\"Bonn\")","category":"section"},{"location":"#References","page":"Home","title":"References","text":"García de Cortázar-Atauri, I.; Brisson, N. and Gaudillere, J. P. (2009). Performance of several models for predicting budburst date of grapevine (Vitis vinifera L.). International Journal of Biometeorology 53, 317–326. Accessed on Aug 18, 2025.\n\n\n\nLegave, J. M.; Blanke, M.; Christen, D.; Giovannini, D.; Mathieu, V. and Oger, R. (2013). A comprehensive overview of the spatial and temporal variability of apple bud dormancy release and blooming phenology in Western Europe. International Journal of Biometeorology 57, 317–331. Accessed on Aug 18, 2025.\n\n\n\n\n\n\n\nThis page was generated using Literate.jl.","category":"section"},{"location":"species/#Phenological-models-for-each-species","page":"Phenological models for each species","title":"Phenological models for each species","text":"","category":"section"},{"location":"species/#Apple","page":"Phenological models for each species","title":"Apple","text":"","category":"section"},{"location":"species/#Grapevine-(BRIN)","page":"Phenological models for each species","title":"Grapevine (BRIN)","text":"","category":"section"},{"location":"species/#Phenology.AppleModel","page":"Phenological models for each species","title":"Phenology.AppleModel","text":"AppleModel(CPO::Tuple{Integer,Integer}=(10, 30),\n    chilling_model::AbstractAction=TriangularAction(1.1, 20.),\n    chilling_target::AbstractFloat=56.0,\n    forcing_model::AbstractAction=ExponentialAction(9.0),\n    forcing_target::AbstractFloat=83.58)\n\nStructure which contains the parameters for a phenelogical apple model. The default values are the ones suggested in (Legave et al., 2013) (F1 Gold 1).\n\n\n\n\n\n","category":"type"},{"location":"species/#Phenology.Apple_Phenology_Pred","page":"Phenological models for each species","title":"Phenology.Apple_Phenology_Pred","text":"Apple_Phenology_Pred(TG_vec::AbstractVector, date_vec::AbstractVector{Date}; model::AppleModel=AppleModel())\nApple_Phenology_Pred(df::DataFrame; model::AppleModel=AppleModel())\nApple_Phenology_Pred(file_TG::String; model::AppleModel=AppleModel())\n\nFrom a series of daily average temperature TG_vec, its dates in date_vec and an apple phenology model model, return the endodormancy break dates and budburst dates in two vectors respectively. The temperatures and dates data can be included in a dataframe (second method) or in a .txt file (third method). See Temperatures data compatibility for further explanation about the way to input temperatures data.\n\n\n\n\n\n","category":"function"},{"location":"species/#Phenology.BRIN_Model","page":"Phenological models for each species","title":"Phenology.BRIN_Model","text":"BRIN_Model(CPO::Tuple{Integer,Integer}=(8, 1),\n    Q10::AbstractFloat=2.17,\n    chilling_target::AbstractFloat=119.0,\n    T0Bc::AbstractFloat=8.19,\n    TMBc::AbstractFloat=25.,\n    forcing_target::AbstractFloat=13236)\nBRIN_Model(date_vec, x, date_vecBB::AbstractVector{Date}; p0=[100., 8000.])\nBRIN_Model(date_vec, x, years, doy; p0=[100., 8000.])\nBRIN_Model(x_vec::AbstractVector, n_train::AbstractVector; p0=[100., 8000.])\n\nStructure which contains the parameters for a phenelogical BRIN model for grapevine. The default values are the ones suggested in (García de Cortázar-Atauri et al., 2009) (table 5 p 323). With the three last methods you can initiate a BRIN_Model by fitting on temperatures, dates et bud burst dates data (see Training BRIN models). It is done with a differential evolution optimization algorithm.\n\n\n\n\n\n","category":"type"},{"location":"species/#Phenology.Vine_Phenology_Pred","page":"Phenological models for each species","title":"Phenology.Vine_Phenology_Pred","text":"Vine_Phenology_Pred(TN_vec::AbstractVector, TX_vec::AbstractVector, date_vec::AbstractVector{Date}, model::BRIN_Model=BRIN_Model())\nVine_Phenology_Pred(file_TN::String, file_TX::String, model::BRIN_Model=BRIN_Model())\nVine_Phenology_Pred(x::AbstractMatrix, date_vec, model::BRIN_Model=BRIN_Model())\nVine_Phenology_Pred(df_TN::DataFrame, df_TX::DataFrame, model::BRIN_Model=BRIN_Model())\nVine_Phenology_Pred(df::DataFrame, model::BRIN_Model=BRIN_Model())\n\nFrom a series of TN TN_vec, a series of TX TX_vec, their dates in date_vec and a vine phenology model model, return the endodormancy break dates and budburst dates in two vectors respectively. The temperatures and dates data can be included in two .txt file, two different dataframes or one dataframe with the two type of temperature. See Temperatures data compatibility for further explanation about the way to input temperatures data.\n\n\n\n\n\n","category":"function"}]
}
